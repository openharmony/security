{
    "month": "2024-09",
    "release_time": "2024-09",
    "vulnerabilities": [
        {
            "month": "2024-09",
            "vul_id": {
                "cve": "CVE-2024-38601",
                "openharmony-sa": ""
            },
            "severity": "medium",
            "vul_description": {
                "zh": "环形缓冲区：修复读取器之间的竞争和调整大小检查rb_get_read_page（）中的读取器代码通过在old->list.prev->next上执行cmpxchg将新的读取器页面交换到环形缓冲区中，以将其指向新页面。",
                "en": "ring-buffer: Fix a race between readers and resize checks The reader code in rb_get_reader_page() swaps a new reader page into the ring buffer by doing cmpxchg on old->list.prev->next to point it to the new page."
            },
            "vul_impact": {
                "zh": "旧的->list.next->prev也会更新，这意味着底层的双向链表暂时不一致，对于环形缓冲区中的某些页面，page->prev->next或page->next->prev可能不等于返回页面。ring_buffer_resize（）中的调整大小操作可以并行调用。它调用rb_check_pages（），可以检测所描述的不一致性并停止进一步跟踪。",
                "en": "old->list.next->prev gets updated too,This means the underlying doubly-linked list is temporarily inconsistent, page->prev->next or page->next->prev might not be equal back to page for some page in the ring buffer. The resize operation in ring_buffer_resize() can be invoked in parallel. It calls rb_check_pages() which can detect the described inconsistency and stop further tracing."
            },
            "disclosure": {
                "zh": "https://gitee.com/openharmony/security/blob/master/zh/security-disclosure/2024/2024-09.md",
                "en": "https://gitee.com/openharmony/security/blob/master/en/security-disclosure/2024/2024-09.md"
            },
            "patch_info": {
                "4.0.x": {
                    "patch_url": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/a74231c4128bcaa8339ebebf5185532baacc1456"
                    ],
                    "patch_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/a74231c4128bcaa8339ebebf5185532baacc1456.patch"
                    ],
                    "diff_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/a74231c4128bcaa8339ebebf5185532baacc1456.diff"
                    ]
                },
                "4.1.x": {
                    "patch_url": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/0a68cffbffc5f178d84e299f6301f0603e126fae"
                    ],
                    "patch_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/0a68cffbffc5f178d84e299f6301f0603e126fae.patch"
                    ],
                    "diff_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/0a68cffbffc5f178d84e299f6301f0603e126fae.diff"
                    ]
                }
            },
            "affected_projects": "kernel_linux_5.10",
            "object_type": "kernel_linux",
            "affected_versions": [
                "4.0.0-4.0.2","4.1.0-4.1.1"
            ],
            "affected_device": {
                "mini": {
                    "liteos": {
                        "rics-v": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                },
                "small": {
                    "liteos": {
                        "rics-v": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    },
                    "linux": {
                        "arm": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                },
                "standard": {
                    "linux": {
                        "arm": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": true,
                                    "yara": {
                                        "affected_files": [
                                            "/dev/block/platform/fe310000.sdhci/by-name/boot_linux"
                                        ],
                                        "yara_rules": [
                                            "TestCaseRule-OpenHarmony-CVE-2024-38601.yara"
                                        ]
                                    }
                                }
                            }
                        },
                        "arm64": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                }
            }
        }
    ]
}