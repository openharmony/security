{
    "month": "2024-10",
    "release_time": "2024-07-29",
    "vulnerabilities": [
        {
            "month": "2024-10",
            "vul_id": {
                "cve": "CVE-2024-41087",
                "openharmony-sa": ""
            },
            "severity": "high",
            "vul_description": {
                "zh": " Linux kernel存在安全漏洞，该漏洞源于在错误处理路径中，kfree(host)被调用了两次，导致双重释放问题。",
                "en": " If e.g. the ata_port_alloc() call in ata_host_alloc() fails, we will jump to the err_out label, which will call devres_release_group(). devres_release_group() will trigger a call to ata_host_release(). ata_host_release() calls kfree(host), so executing the kfree(host) in ata_host_alloc() will lead to a double free"
            },
            "vul_impact": {
                "zh": " 导致双重释放： 内核 BUG 位于 mm/slub.c：553！ 糟糕：无效的操作码：0000 [#1] 抢占 SMP NOPTI CPU：11 PID：599 通信：（udev-worker）未受污染 6.10.0-rc5 #47 硬件名称：QEMU 标准 PC （i440FX + PIIX， 1996），BIOS 1.16.3-2.fc40 2014 年 4 月 1 日 RIP：0010：kfree+0x2cf/0x2f0 代码： 5d 41 5e 41 5f 5d e9 80 d6 ff ff 4d 89 f1 41 b8 01 00 00 00 48 89 d9 48 89 da RSP： 0018：ffffc90000f377f0 EFLAGS： 00010246 RAX：ffff888112b1f2c0 RBX：ffff888112b1f2c0 RCX：ffff888112b1f320 RDX：000000000000400b RSI：ffffffffc02c9de5 RDI：ffff888112b1f2c0 RBP： ffffc90000f37830 R08： 00000000000000000 R09： 000000000000000000 R10： ffffc90000f37610 R11： 617461203a736b6e R12： ffffea00044ac780 R13： ffff888100046400 R14： ffffffffc02c9de5 R15： 0000000000000006 FS： 00007f2f1cabe980（0000） GS：ffff88813b380000（0000） knlGS：0000000000000000 CS： 0010 DS： 0000 ES： 0000 CR0： 0000000080050033 CR2：00007f2f1c3acf75 CR3：0000000111724000 CR4：00000000000750ef0 PKRU：55555554 调用跟踪： <任务> ?__die_body.cold+0x19/0x27 ?模具 + 0x2e/0x50 ?do_trap+0xca/0x110 ?do_error_trap+0x6a/0x90 ?KFREE+0x2cf/0x2f0 ?exc_invalid_op+0x50/0x70 ?KFREE+0x2cf/0x2f0 ?asm_exc_invalid_op+0x1a/0x20 ?ata_host_alloc+0xf5/0x120 [libata] ?ata_host_alloc+0xf5/0x120 [libata] ?KFREE+0x2cf/0x2f0 ata_host_alloc+0xf5/0x120 [libata] ata_host_alloc_pinfo+0x14/0xa0 [libata] ahci_init_one+0x6c9/0xd20 [AHCI]  ",
                "en": " l lead to a double free: kernel BUG at mm/slub.c:553! Oops: invalid opcode: 0000 [#1] PREEMPT SMP NOPTI CPU: 11 PID: 599 Comm: (udev-worker) Not tainted 6.10.0-rc5 #47 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-2.fc40 04/01/2014 RIP: 0010:kfree+0x2cf/0x2f0 Code: 5d 41 5e 41 5f 5d e9 80 d6 ff ff 4d 89 f1 41 b8 01 00 00 00 48 89 d9 48 89 da RSP: 0018:ffffc90000f377f0 EFLAGS: 00010246 RAX: ffff888112b1f2c0 RBX: ffff888112b1f2c0 RCX: ffff888112b1f320 RDX: 000000000000400b RSI: ffffffffc02c9de5 RDI: ffff888112b1f2c0 RBP: ffffc90000f37830 R08: 0000000000000000 R09: 0000000000000000 R10: ffffc90000f37610 R11: 617461203a736b6e R12: ffffea00044ac780 R13: ffff888100046400 R14: ffffffffc02c9de5 R15: 0000000000000006 FS: 00007f2f1cabe980(0000) GS:ffff88813b380000(0000) knlGS:0000000000000000 CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 00007f2f1c3acf75 CR3: 0000000111724000 CR4: 0000000000750ef0 PKRU: 55555554 Call Trace: <TASK> ? __die_body.cold+0x19/0x27 ? die+0x2e/0x50 ? do_trap+0xca/0x110 ? do_error_trap+0x6a/0x90 ? kfree+0x2cf/0x2f0 ? exc_invalid_op+0x50/0x70 ? kfree+0x2cf/0x2f0 ? asm_exc_invalid_op+0x1a/0x20 ? ata_host_alloc+0xf5/0x120 [libata] ? ata_host_alloc+0xf5/0x120 [libata] ? kfree+0x2cf/0x2f0 ata_host_alloc+0xf5/0x120 [libata] ata_host_alloc_pinfo+0x14/0xa0 [libata] ahci_init_one+0x6c9/0xd20 [ahci]"
            },
            "disclosure": {
                "zh": "https://gitee.com/openharmony/security/blob/master/zh/security-disclosure/2024/2024-10.md",
                "en": "https://gitee.com/openharmony/security/blob/master/en/security-disclosure/2024/2024-10.md"
            },
            "patch_info": {
                "4.0.x": {
                    "patch_url": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/47f7e068e17da010693a6e654ab23bb7f0bfe40a"
                    ],
                    "patch_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/47f7e068e17da010693a6e654ab23bb7f0bfe40a.patch"
                    ],
                    "diff_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/47f7e068e17da010693a6e654ab23bb7f0bfe40a.diff"
                    ]
                },
                "4.1.x":{
                    "patch_url": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/067b606ab11996d043aba3c06f7e4fa809384209"
                    ],
                    "patch_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/067b606ab11996d043aba3c06f7e4fa809384209.patch"
                    ],
                    "diff_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/067b606ab11996d043aba3c06f7e4fa809384209.diff"
                    ]
                }
            },
            "affected_projects": "kernel_linux_5.10",
            "object_type": "kernel_linux",
            "affected_versions": [
                "4.0.0-4.0.2","4.1.0-4.1.1"
            ],
            "affected_device": {
                "mini": {
                    "liteos": {
                        "rics-v": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                },
                "small": {
                    "liteos": {
                        "rics-v": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    },
                    "linux": {
                        "arm": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                },
                "standard": {
                    "linux": {
                        "arm": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": true,
                                    "yara": {
                                        "affected_files": [
                                            "/dev/block/platform/fe310000.sdhci/by-name/boot_linux"
                                        ],
                                        "yara_rules": [
                                            "TestcaseRule-OpenHarmony-CVE-2024-41087.yara"
                                        ]
                                    }
                                }
                            }
                        },
                        "arm64": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                }
            }
        }
    ]
}