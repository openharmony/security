{
    "month": "2024-05",
    "release_time": "2024-05-17",
    "vulnerabilities": [
        {
            "month": "2024-05",
            "vul_id": {
                "cve": "CVE-2024-35822",
                "openharmony-sa": ""
            },
            "severity": "low",
            "vul_description": {
                "zh": " 该漏洞源于大容量存储函数尝试对来自主线程的请求进行排队，但当函数禁用时其他线程可能已经禁用了 ep。",
                "en": "Root cause is mass storage function try to queue request from main thread, but other thread may already disable ep when function disable."
            },
            "vul_impact": {
                "zh": " usb：udc：禁用队列时删除警告 ep 大容量存储功能可能会触发以下警告消息，警告：CPU：6 PID：3839 at drivers/usb/gadget/udc/core.c：294 usb_ep_queue+0x7c/0x104 pc ： usb_ep_queue+0x7c/0x104 lr： fsg_main_thread+0x494/0x1b3c ",
                "en": " usb: udc: remove warning when queue disabled ep It is possible trigger below warning message from mass storage function, WARNING: CPU: 6 PID: 3839 at drivers/usb/gadget/udc/core.c:294 usb_ep_queue+0x7c/0x104 pc : usb_ep_queue+0x7c/0x104 lr : fsg_main_thread+0x494/0x1b3c"
            },
            "disclosure": {
                "zh": "https://gitee.com/openharmony/security/blob/master/zh/security-disclosure/2024/2024-08.md",
                "en": "https://gitee.com/openharmony/security/blob/master/zh/security-disclosure/2024/2024-08.md"
            },
            "patch_info": {
                "4.0.x": {
                    "patch_url": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/584c3e6eeab5325c56dd9829d53dab9a40db4fa8"
                    ],
                    "patch_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/584c3e6eeab5325c56dd9829d53dab9a40db4fa8.patch"
                    ],
                    "diff_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/584c3e6eeab5325c56dd9829d53dab9a40db4fa8.diff"
                    ]
                },
                "4.1.x":{
                    "patch_url": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/4adab09f28a3b1e91fb5a3b5d1c9f2b86b94f5b9"
                    ],
                    "patch_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/4adab09f28a3b1e91fb5a3b5d1c9f2b86b94f5b9.patch"
                    ],
                    "diff_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/4adab09f28a3b1e91fb5a3b5d1c9f2b86b94f5b9.diff"
                    ]
                }
            },
            "affected_projects": "kernel_linux_5.10",
            "object_type": "kernel_linux",
            "affected_versions": [
                "4.0.0-4.0.1","4.1"
            ],
            "affected_device": {
                "mini": {
                    "liteos": {
                        "rics-v": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                },
                "small": {
                    "liteos": {
                        "rics-v": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    },
                    "linux": {
                        "arm": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                },
                "standard": {
                    "linux": {
                        "arm": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": true,
                                    "yara": {
                                        "affected_files": [
                                            "/dev/block/platform/fe310000.sdhci/by-name/boot_linux"
                                        ],
                                        "yara_rules": [
                                            "TestcaseRule-OpenHarmony-CVE-2024-35822.yara"
                                        ]
                                    }
                                }
                            }
                        },
                        "arm64": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                }
            }
        }
    ]
}