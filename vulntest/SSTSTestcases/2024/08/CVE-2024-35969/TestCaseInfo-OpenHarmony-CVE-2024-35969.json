{
    "month": "2024-08",
    "release_time": "2024-05-17",
    "vulnerabilities": [
        {
            "month": "2024-08",
            "vul_id": {
                "cve": "CVE-2024-35969",
                "openharmony-sa": ""
            },
            "severity": "medium",
            "vul_description": {
                "zh": "在 ipv6_get_ifaddr 和 ipv6_del_addr 之间可能存在竞争条件。虽然 ipv6_get_ifaddr 在 RCU 锁的保护下遍历 inet6_addr_lst，但这仍然意味着 hlist_for_each_entry_rcu 可能返回一个已从列表中移除的项目。",
                "en": "race condition between ipv6_get_ifaddr and ipv6_del_addr Although ipv6_get_ifaddr walks inet6_addr_lst under the RCU lock, it still means hlist_for_each_entry_rcu can return an item that got removed from the list."
            },
            "vul_impact": {
                "zh": "如果 ipv6_del_addr 被并行调用，就有可能发生这种情况。ipv6_del_addr 会从 inet6_addr_lst 中移除条目（通过 hlist_del_init_rcu(&ifp->addr_lst)），并释放所有引用（通过 __in6_ifa_put(ifp) 和 in6_ifa_put(ifp)）。",
                "en": "This can happen if ipv6_del_addr is called in parallel. ipv6_del_addr removes the entry from inet6_addr_lst (hlist_del_init_rcu(&ifp->addr_lst)) and drops all references (__in6_ifa_put(ifp) + in6_ifa_put(ifp))."
            },
            "disclosure": {
                "zh": "https://gitee.com/openharmony/security/blob/master/zh/security-disclosure/2024/2024-08.md",
                "en": "https://gitee.com/openharmony/security/blob/master/en/security-disclosure/2024/2024-08.md"
            },
            "patch_info": {
                "4.0.x": {
                    "patch_url": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/7970c5e7d1586b42b41b1917099f4b322dd8a0ec"
                    ],
                    "patch_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/7970c5e7d1586b42b41b1917099f4b322dd8a0ec.patch"
                    ],
                    "diff_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/7970c5e7d1586b42b41b1917099f4b322dd8a0ec.diff"
                    ]
                },
                "4.1.x": {
                    "patch_url": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/d476d1c7eb53ded6d6800f8d025ca79aec8036a4"
                    ],
                    "patch_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/d476d1c7eb53ded6d6800f8d025ca79aec8036a4.patch"
                    ],
                    "diff_file": [
                        "https://gitee.com/openharmony/kernel_linux_5.10/commit/d476d1c7eb53ded6d6800f8d025ca79aec8036a4.diff"
                    ]
                }
            },
            "affected_projects": "kernel_linux_5.10",
            "object_type": "kernel_linux",
            "affected_versions": [
                "4.0.0-4.0.1",
                "4.1.0-4.1.1"
            ],
            "affected_device": {
                "mini": {
                    "liteos": {
                        "rics-v": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                },
                "small": {
                    "liteos": {
                        "rics-v": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    },
                    "linux": {
                        "arm": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                },
                "standard": {
                    "linux": {
                        "arm": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": true,
                                    "yara": {
                                        "affected_files": [
                                           "/dev/block/platform/fe310000.sdhci/by-name/boot_linux"
                                        ],
                                        "yara_rules": [
                                            "TestCaseRule-OpenHarmony-CVE-2024-35969.yara"
                                        ]
                                    }
                                }
                            }
                        },
                        "arm64": {
                            "scan_strategy": {
                                "ssts": {
                                    "enable": false
                                },
                                "ists": {
                                    "enable": false
                                }
                            }
                        }
                    }
                }
            }
        }
    ]
}